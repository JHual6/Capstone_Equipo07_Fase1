SELECT SUM(cantidad_mer), nombre_flor, color_flor FROM merma INNER JOIN detalle_lote ON detalle_lote.id_detlote = merma.id_detlote INNER JOIN flores ON flores.id_flor = detalle_lote.id_flor GROUP BY flores.nombre_flor, color_flor;

SELECT SUM(detalle_lote.ventas_detlote), flores.nombre_flor, color_flor FROM detalle_lote INNER JOIN flores ON flores.id_flor = detalle_lote.id_flor  GROUP BY flores.nombre_flor, color_flor;

SELECT SUM(detalle_lote.farreglo_detlote), flores.nombre_flor, color_flor FROM detalle_lote INNER JOIN flores ON flores.id_flor = detalle_lote.id_flor  GROUP BY flores.nombre_flor, color_flor;

SELECT SUM(total_ven) FROM ventas GROUP BY EXTRACT(YEAR FROM fecha_ven), EXTRACT(MONTH FROM fecha_ven)

SELECT SUM(precio_mer) FROM merma GROUP BY EXTRACT(YEAR FROM fecha_mer), EXTRACT(MONTH FROM fecha_mer)



SELECT 	v.total_ven, v.fecha_ven,
		c.hora_clima, c.lluvia_clima, c.temperatura_clima, c.humedad_clima, c.desc_clima,
		vel.cantidad_velorio
FROM ventas v 
INNER JOIN clima c ON c.id_clima = v.id_clima
INNER JOIN velorios vel ON vel.fecha_velorio = v.fecha_ven



DROP SCHEMA public CASCADE;
CREATE SCHEMA public;
GRANT ALL ON SCHEMA public TO postgres;
GRANT ALL ON SCHEMA public TO public;